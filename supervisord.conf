[supervisord]
nodaemon=true ; Run in the foreground, required for Docker containers

[program:tts]
command=/bin/bash -c "source /workspace/dockerless/.venv/bin/activate && moshi-server worker --config /workspace/services/moshi-server/configs/tts.toml --port 8089"
directory=/workspace
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:stt]
command=/bin/bash -c "source /workspace/dockerless/.venv/bin/activate && moshi-server worker --config /workspace/services/moshi-server/configs/stt.toml --port 8090"
directory=/workspace
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:backend]
# Note: --reload is removed as it's for development, not for a production image.
command=/bin/bash -c "source /workspace/backend_venv/bin/activate && uvicorn unmute.main_websocket:app --host 0.0.0.0 --port 8000 --ws-per-message-deflate=false"
directory=/workspace
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0